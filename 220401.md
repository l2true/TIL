# 220401ğŸ•



## ìˆœí™˜ ì‹ ê²½ë§ (Recurrent Neural Network, RNN)

ê´€ë ¨ ìë£Œ https://wikidocs.net/22886 



### 1. TimeSeries Data (ì‹œê³„ì—´ ë°ì´í„°)

Full-connected/CNNì€ ì •ì§€ëœ ìƒíƒœì—ì„œ ì •ë‹µì„ ì˜ˆì¸¡

- (ë°ì´í„°: ì •ë‹µ) í˜•íƒœë¥¼ í•™ìŠµì‹œí‚¤ê³  ë¬¸ì œ -> í•´ê²°ì„ í†µí•´ ì •ë‹µì„ ë„ì¶œí•˜ëŠ” ê³¼ì •

ì •ì§€ëœ ìƒíƒœê°€ ì•„ë‹Œ, ì‹œê°„ì— ì˜í–¥ì„ ë°›ì•„ íë¥´ê³  ìˆëŠ” ë°ì´í„°ë¥¼ ì˜ˆì¸¡í•˜ë ¤ë©´?



#### 1) Sequence Data (ìˆœì°¨ ë°ì´í„°)

- Sequence Data: ìˆœì„œê°€ ì˜ë¯¸ê°€ ìˆìœ¼ë©°, ìˆœì„œê°€ ë‹¬ë¼ì§ˆ ê²½ìš° ì˜ë¯¸ê°€ ì†ìƒë˜ëŠ” ë°ì´í„°

  - ìì—°ì–´ ë¬¸ì¥

  - ì‹¬ì „ë„

  - ë™ì˜ìƒ

  - ì£¼ê°€

- Temporal Sequence: ì‹œê°„ì  ì˜ë¯¸ê°€ ìˆëŠ” ê²½ìš°

- Time Series: ì¼ì •í•œ ì‹œê°„ì°¨ë¥¼ ê°€ì§



#### 2) TimeSeries Dataì˜ ë¶„ë¥˜

- Deterministic

  - ì–´ë–¤ íŠ¹ì •í•œ ì…ë ¥ì´ ë“¤ì–´ì˜¤ë©´ ì–¸ì œë‚˜ ë˜‘ê°™ì€ ê³¼ì •ì„ ê±°ì³ ë˜‘ê°™ì€ ê²°ê³¼ë¥¼ ë‚´ë³´ë‚´ëŠ” ë°ì´í„°

- Stochastic

  - ê³¼ê±°ì˜ ë°ì´í„°ê°€ ë¯¸ë˜ì˜ ë°ì´í„°ì— ì˜í–¥ì„ ë¯¸ì¹˜ì§€ë§Œ, í™•ë¥ ì ìœ¼ë¡œ ë³€í™”í•˜ëŠ” ë°ì´í„°

  - Stationary: ì‹œê°„ì´ ë³€í•´ë„ í‰ê· , ë¶„ì‚° ë³€í•˜ì§€ ì•ŠìŒ -> íŠ¹ì • ë¶„í¬ë¥¼ ë”°ë¼ê°

  - Non-Stationary: ë§¤ ì‹œê°„ë§ˆë‹¤ í‰ê· ê³¼ ë¶„ì‚°ì´ ë°”ë€œ -> ë¶„í¬ë¥¼ ì˜ˆì¸¡í•˜ê¸°ê°€ ì–´ë ¤ì›€

    ![image-20220404175356770](220401.assets/image-20220404175356770.png)



### 2. ì‹œê³„ì—´ ë°ì´í„°ì˜ ì˜ˆì¸¡

#### 1) Markov Chain



### 3. RNN ì‹¤ìŠµ

```PYTHON
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt

x = np.linspace(0, 100, 1001)
x = np.round(x, 1) # ì†Œìˆ«ì  ë¬¸ì œê°€ ì¡´ì¬í•´ì„œ ì²«ì§¸ìë¦¬ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ë°˜ì˜¬ë¦¼
y = np.sin(x) #wave data ë¥¼ í•™ìŠµì‹œì¼œ ë³´ì 
plt.plot(x, y)

# Test dataì™€ train ë°ì´í„°ë¡œ ë‚˜ëˆ ì¤€ë‹¤.
df = pd.DataFrame(data=y, index=x, columns=["sine_wave"])
train = df.iloc[:801]
test = df.iloc[801:]


# scale data
# ìˆ«ìê°€ ë„ˆë¬´ ì»¤ë„ í•™ìŠµì´ ì˜ì•ˆë˜ê³ , ìŒìˆ˜ê°€ ê°€ ìˆì–´ë„ í•™ìŠµì´ ì˜ì•ˆëœë‹¤. 
from sklearn.preprocessing import MinMaxScaler
scaler = MinMaxScaler()
scaler.fit(train)
s_train = scaler.transform(train)
s_test = scaler.transform(test)

# Time series Generator
# regression ê°™ì€ ê²½ìš°ëŠ” x ê°’ì„ ëŒ€ì…í•˜ë©´ yê°’ì´ ë‚˜ì˜¤ê²Œë” í•™ìŠµì‹œí‚¤ì§€ë§Œ, 
# Sequential ë°ì´í„°ë¥¼ ì˜ˆì¸¡í•˜ëŠ” ê²½ìš° íŠ¹ì • ê¸°ê°„ë‚´ì˜ dataê°€ ë¯¸ë˜ ë°ì´í„°ì— ì˜í–¥ì„ ì£¼ê¸° ë•Œë¬¸ì—
# timeseriesGenerator ë¥¼ ì‚¬ìš©í•´ ë°ì´í„° ë¬¶ìŒì„ ë§Œë“¤ì–´ ì¤€ë‹¤. 
from tensorflow.keras.preprocessing.sequence import TimeseriesGenerator

length = 50 ( ê¸¸ì´ê°€ 50ì¸ data)
generator = TimeseriesGenerator(s_train, s_train, length=length, batch_size=1)

generator[0] # (array([[[4.99998429e-01],[5.49915469e-01],[5.99333755e-01],...]]), array([[0.0205331]])) <- generator[0][0]ì´ íƒ€ê²Ÿ ë°ì´í„°

# model ìƒì„±
import tensorflow as tf

model = tf.keras.models.Sequential()
model.add(tf.keras.layers.SimpleRNN(100, input_shape=(50,1)))
model.add(tf.keras.layers.Dense(1))

model.summary()

model.compile(optimizer="adam", loss="mse")
model.fit(generator, epochs=4)

# test dataset ë³€ê²½
s_g_test = TimeseriesGenerator(s_test, s_test, length=length, batch_size=1)

# test dataì˜ 51ë²ˆì§¸ ê°’ ì˜ˆì¸¡
predict_test = model.predict(s_g_test)
true_predict = scaler.inverse_transform(predict_test)

true_predict.shape # (150, 1)
test.shape # (200, 1)
# test dataì˜ ì•ì˜ 50ê°œì˜ ë°ì´í„°ë¥¼ ì´ìš©í•´ 51ë²ˆì§¸ ë°ì´í„°ë¥¼ ì˜ˆì¸¡í–ˆê¸° ë•Œë¬¸ì— ì•ë¶€ë¶„ 50ì˜ ë°ì´í„°ëŠ” ì‚¬ë¼ì§„ë‹¤. 
# ì˜ˆ 0,1,2,3,4,~49 -> 50
# ì›ë˜ ë°ì´í„° 0~200
# ì˜ˆì¸¡ ë°ì´í„° 50~201

# ì‹¤ì œê°’ê³¼ ì˜ˆì¸¡ê°’ ë¹„êµí•˜ê¸°
test2 = test.drop(test.index[0:length]) # ì‹¤ì œê°’ìœ¼ë¡œ êµ¬ì„±ëœ dataframe 
test2["predict_test_simplernn"] = true_predict #ì˜ˆì¸¡ê°’ì„ dataframe ì— ì¶”ê°€

plt.plot(test2.index, test2.sine_wave, linewidth = 5.0)
plt.plot(test2.index, test2.predict_test_simplernn, linewidth = 2.0)
```

![image-20220406154944256](220401.assets/image-20220406154944256.png)ã…‡