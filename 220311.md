# 220311 ğŸ•



## í‘œë³¸ ì¶”ì¶œ



### 1. í‘œë³¸ ì¶”ì¶œì˜ ì¢…ë¥˜

- ë‹¨ìˆœ ì„ì˜ ì¶”ì¶œ (SRS) : ë³„ë„ì˜ ê·œì¹™ì´ ì¡´ì¬í•˜ì§€ ì•Šì€ ë³´í†µì˜ ì„ì˜ì¶”ì¶œ
- ì¸µí™” ì„ì˜ ì¶”ì¶œ : êµ°ì§‘ ë³„ë¡œ ì§€ì •í•œ ë¹„ìœ¨ ë§Œí¼ì˜ ë°ì´í„°ë¥¼ ì„ì˜ì¶”ì¶œ
  - ì½”í˜¸íŠ¸ ë¶„ì„ ex) ì–´ë–¤ ì•½ì´ ì œëŒ€ë¡œ íš¨ê³¼ê°€ ìˆëŠ”ì§€ ì„±ë¹„ ë³„ë¡œ ë¶„ì„
- ê³„í†µ ì¶”ì¶œ : ì²« í‘œë³¸ì„ ë¬´ì‘ìœ„ë¡œ ì¶”ì¶œí•˜ê³  í‘œì§‘ ê°„ê²© kë§Œí¼ ë–¨ì–´ì§„ ê³³ì˜ ë°ì´í„° ì¶”ì¶œ
  - í¸í–¥ì„± ë¬¸ì œ
- êµ°ì§‘ ì¶”ì¶œ : ì†Œìˆ˜ì˜ êµ°ì§‘ìœ¼ë¡œ ë¶„í• í•˜ê³  ì¼ì • ìˆ˜ì˜ ì†Œì§‘ë‹¨ì„ ì„ì˜ í‘œë³¸ ì¶”ì¶œ



### 2. ì£¼ìš” í•¨ìˆ˜ ë° ë©”ì„œë“œ

- **pandas - sample()**
  - ë‹¨ìˆœ ì„ì˜ ì¶”ì¶œì„ ìˆ˜í–‰í•˜ëŠ” ë©”ì„œë“œ
  - n: í‘œë³¸ ê°œìˆ˜, frac: ë¹„ìœ¨, random_state: í‘œë³¸ ì¶”ì¶œ ê²°ê³¼ ê³ ì •, replace: ë³µì› ì¶”ì¶œ ì—¬ë¶€, weights: ê°€ì¤‘ì¹˜
  - groupby() ë©”ì„œë“œë¥¼ ì¶”ê°€í•˜ë©´ ì¸µí™” í‘œë³¸ ì¶”ì¶œ ê°€ëŠ¥
- **sklern - train_test_split()**
  - ì…ë ¥ DataFrame/arrayë¥¼ ë‘ set(í•™ìŠµ, í‰ê°€)ë¡œ ë‚˜ëˆ„ëŠ” í•¨ìˆ˜
  - train_size/test_sizeì— ê°œìˆ˜ ë˜ëŠ” ë¹„ìœ¨ ì…ë ¥ -> í‘œë³¸ ê°œìˆ˜ ì¡°ì ˆ
  - random_state: í‘œë³¸ ì¶”ì¶œ ê²°ê³¼ ê³ ì •



### 3. ìì „ê±° ëŒ€ì—¬ ë°ì´í„° ì‹¤ìŠµ - bike.csv

```python
# ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
import pandas as pd
from sklearn.model_selection import train_test_split

df = pd.read_csv('bike.csv')

# 2ê°œì˜ í‘œë³¸ ì„ì˜ ì¶”ì¶œ
df.sample(n = 2, random_state = 1234)

# seasonë³€ìˆ˜ë³„ë¡œ 2ê°œì”© í‘œë³¸ ì¶”ì¶œ
df['season'].unique() # season ë³€ìˆ˜ì˜ ê³ ìœ ê°’ í™•ì¸
df['season'].nunique() # season ë³€ìˆ˜ì˜ ê³ ìœ ê°’ì˜ ê°œìˆ˜
df.groupby('season').sample(n = 2, random_state = 1234)

# 0.5%ë¥¼ ì„ì˜ ì¶”ì¶œ
df.sample(frac = 0.005, random_state = 1234)

# í–‰ ê°œìˆ˜ í™•ì¸
len(df.sample(frac = 0.005, random_state = 1234)) 
df.sample(frac = 0.005, random_state = 1234).shape[0]

# train, testì…‹ ë¶„ë¦¬
df_train, df_test = train_test_split(df, train_size = 0.7, random_state = 1234)

df_train.head(2)
print(len(df_train))
print(len(df_test))

# ì£¼ì–´ì§„ ë°ì´í„°ì˜ 1.23%ë¥¼ ì¶”ì¶œí•˜ë©´ ëª‡ ê°œì˜ í–‰ì´ ì¶”ì¶œ?
len(df.sample(frac = 0.0123))

# season ê¸°ì¤€ 5%ì”© ì¶”ì¶œ ì‹œ ì¶”ì¶œë˜ëŠ” ì´ í–‰ì˜ ìˆ˜?
len(df.groupby('season').sample(frac = 0.05))

# í•™ìŠµ, í‰ê°€ ë°ì´í„° ì„¸íŠ¸ 8:2 ë¶„ë¦¬ì‹œ í‰ê°€ìš© ë°ì´í„°ì˜ ìµœê³ ê¸°ì˜¨?
df_train, df_test = train_test_split(df, train_size = 0.8, random_state = 123)
df_test['temp'].max()
```



## ë°ì´í„° ì „ì²˜ë¦¬

### 1. ì´ìƒì¹˜

- **ì¤‘ì‹¬ ê²½í–¥ì„±**ì—ì„œ ë©€ë¦¬ ë–¨ì–´ì§„ ê°’

- ì²˜ë¦¬ ë°©ë²•
  - ì ˆëŒ€ì  ê¸°ì¤€x
  - Carling, Tukey
  - ë¶„í¬ ê¸°ë°˜ ì²˜ë¦¬ ex) ì •ê·œë¶„í¬ ê¸°ë°˜ í•˜ìœ„ 1%



### 2. ê²°ì¸¡ì¹˜

- ê°’ì´ ê¸°ë¡ë˜ì§€ ì•Šê³  ë¹„ì–´ìˆìŒ
- ì²˜ë¦¬ ë°©ë²•
  - ì ˆëŒ€ì  ê¸°ì¤€x
  - ë‹¨ìˆœ ì œê±°: ë¶„ì„ ë°ì´í„°ì—ì„œ ê²°ì¸¡ì¹˜ê°€ ì°¨ì§€í•˜ëŠ” ë¹„ì¤‘ ë‚®ì€ ê²½ìš°
  - íŠ¹ì • ê°’ ëŒ€ì²´: ì‹œê³„ì—´ ë°ì´í„°ì—ì„œì˜ ì„ í˜• ë³´ê´€ 
    - ex) ì½”ë¡œë‚˜ í™•ì§„ì ìˆ˜: ì „ë‚ ê³¼ ë‹¤ìŒë‚ ì˜ ê°€ìš´ë°ê°’ìœ¼ë¡œ ëŒ€ì²´ 

- ì£¼ìš” í•¨ìˆ˜ ë° ë©”ì„œë“œ

  - **pandas - isna(), isnull()**
    - ê²°ì¸¡ì¹˜ ì›ì†Œë¥¼ T, ê´€ì¸¡ì¹˜ë¥¼ Fë¡œ ë°˜í™˜í•˜ëŠ” ë©”ì„œë“œ
    - ë°˜ëŒ€ì˜ ê¸°ëŠ¥: notna(), notnull()
  - **pandas - fillna()**
    - ê²°ì¸¡ì¹˜ë¥¼ ì±„ì›Œ ë„£ê¸° ìœ„í•œ ë©”ì„œë“œ
    - value ì¸ìì— ê²°ì¸¡ì¹˜ë¥¼ ì±„ì›Œ ë„£ì„ ê°’ì„ ì…ë ¥ (ë”•ì…”ë„ˆë¦¬ ê°€ëŠ¥)
    - method - bfill: ë’¤ì˜ ê°’, ffill: ì•ì˜ ê°’ì„ ì°¸ê³ 

  ```python
  # iris_missing.csv(ë¶“ê½ƒ ê²°ì¸¡ ë°ì´í„°) ë¶ˆëŸ¬ì˜¤ê¸°
  import pandas as pd
  
  df = pd.read_csv("iris_missing.csv")
  df_na = df.head(7)
  
  # isna()ë¡œ 'Sepal_Length'ë³€ìˆ˜ì˜ ê²°ì¸¡ì¹˜ í™•ì¸
  df_na['Sepal_Length'].isna()
  df_na['Sepal_Length'].notna()
  
  # isna().sum()ìœ¼ë¡œ ê²°ì¸¡ì¹˜ ê°œìˆ˜ ì„¸ê¸°
  df_na.isna().sum() # ê° ë³€ìˆ˜ë³„ ê²°ì¸¡ì¹˜ ê°œìˆ˜
  df_na.isna().sum(axis = 1) # ê° rowë³„ ê²°ì¸¡ì¹˜ ê°œìˆ˜
  df_na['Sepal_Length'].isna().sum() 
  
  # fillna()ë¡œ ê²°ì¸¡ì¹˜ì— ëŒ€ì²´ê°’ ì±„ì›Œ ë„£ê¸°
  df_na.fillna(value = 999)
  df_na.fillna(value = {'Sepal_Length' : 999})
  df_na.fillna(value = {'Sepal_Length' : 999, 
                       'Sepal_Width' : 999})
  df_na = df_na.fillna(value = {'Sepal_Width' :
                                df_na['Sepal_Width'].mean()}) # í‰ê· ê°’ìœ¼ë¡œ ì±„ì›Œë„£ê¸°
  ```

  - **pandas - dropna()**
    - ê²°ì¸¡ì¹˜ê°€ ìˆëŠ” rowë‚˜ columnì„ ì œê±°í•˜ê¸° ìœ„í•œ ë©”ì„œë“œ
    - how ì¸ìì˜ 'any': ê²°ì¸¡ì¹˜ê°€ í•˜ë‚˜ë¼ë„ ìˆëŠ” ê²½ìš°, 'all': ì „ì²´ê°€ ê²°ì¸¡ì¹˜ì¸ ê²½ìš° ì œê±°
  - **pandas - puantile()**
    - ë¶„ìœ„ìˆ˜ë¥¼ ì—°ì‚°í•˜ëŠ” ë©”ì„œë“œ
    - qì¸ìì— 1ê°œ ì´ìƒì˜ í™•ë¥ ê°’(0-1) ì…ë ¥í•˜ì—¬ ê·¸ì— ë§ëŠ” ë¶„ìœ„ìˆ˜ ì‚°ì¶œ

  ```python
  df = pd.read_csv("iris_missing.csv")
  df_na2 = df.head(7)
  df_na2
  
  # dropna()ë¡œ ê²°ì¸¡ì¹˜ ì œê±°
  df_na2.dropna()
  df_na2.iloc[:, :-1].dropna(how = 'all') # Speciesì—´ì„ ì œì™¸í•œ ë°ì´í„°í”„ë ˆì„ì—ì„œ í–‰ ì „ì²´ê°€ ê²°ì¸¡ì¹˜ë¡œ êµ¬ì„±ëœ ê²½ìš° ê²°ì¸¡ì¹˜ ì œê±°
  
  
  # quantile()ë¡œ ì‚¬ë¶„ìœ„ ê³„ì‚°
  print(df['Sepal_Length'].quantile(q = 0.25)) # ì œ 1ì‚¬ë¶„ìœ„
  print(df['Sepal_Length'].quantile(q = 0.5)) # ì œ 2ì‚¬ë¶„ìœ„
  print(df['Sepal_Length'].quantile(q = 0.75)) # ì œ 3ì‚¬ë¶„ìœ„
  
  # ê° ìˆ˜ì¹˜í˜• ë³€ìˆ˜ì˜ ê²°ì¸¡ì¹˜ ê°œìˆ˜ ì´í•©?
  df.iloc[:,:-1].isna().sum().sum()
  
  # sepal_width ë³€ìˆ˜ì˜ ê²°ì¸¡ì¹˜ë¥¼ í‰ê· ìœ¼ë¡œ ëŒ€ì¹˜í•œ ê°’ì˜ ë¶„ì‚°? (ì†Œìˆ˜ì  3ìë¦¬)
  df = df.fillna(value = {'Sepal_Width' : df_na['Sepal_Width'].mean()})
  round(df['Sepal_Width'].var(), 3)
  
  # í‰ê· ì„ ê¸°ì¤€ìœ¼ë¡œ 1.5 í‘œì¤€í¸ì°¨ë¥¼ ë„˜ì–´ì„œëŠ” ê°’ì„ ì´ìƒì¹˜ë¡œ ê°„ì£¼í•  ë•Œ, Sepal.length ë³€ìˆ˜ë¥¼ ê¸°ì¤€ìœ¼ë¡œ ì´ìƒì¹˜ì¸ row ê°œìˆ˜ëŠ” ëª‡ ê°œ?
  df = pd.read_csv("iris.csv")
  sl_mean = df['Sepal.Length'].mean()
  sl_std = df['Sepal.Length'].std()
  
  con1 = df['Sepal.Length'] < (sl_mean - 1.5 * sl_std) 
  con2 = df['Sepal.Length'] > (sl_mean + 1.5 * sl_std)
  
  df_out = df.loc[con1 | con2, ]
  len(df_out)
