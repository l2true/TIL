# 220330ğŸ•



## Dense Layer



### 3. MNIST ì†ê¸€ì”¨ ë°ì´í„° ì˜ˆì¸¡

```PYTHON
import tensorflow as tf
from tensorflow.keras.datasets import mnist
import numpy as np 
import matplotlib.pyplot as plt

# mnist ë°ì´í„° ë¶ˆëŸ¬ì˜¤ê¸°
(x_train, y_train), (x_test, y_test) = mnist.load_data()

# ë°ì´í„° í˜•íƒœ ë³´ê¸°
x_train.shape # (60000, 28, 28) -> ì´ 60000ì¥, í•œì¥ì€ 28*28 í”½ì…€ë¡œ ì´ë£¨ì–´ì ¸ ìˆìŒ
y_train.shape # (60000,) # 60000ê°œì˜ ë²¡í„° (0~9ê¹Œì§€ì˜ ìˆ˜ë“¤ë¡œ êµ¬ì„±ë¨)

# x_train[0]ì˜ ê·¸ë¦¼ ë³´ê¸°
plt.imshow(x_train[0], cmap="gray")
plt.title(f"class{y_train[0]}") # y_train[0] = 5 ì´ë¯€ë¡œ 'class5'ë¼ëŠ” ì œëª©ì´ ë¶™ì—¬ì§
```

![image-20220401173013696](220330.assets/image-20220401173013696.png)

```PYTHON
# ë°ì´í„° í¬ê¸° ë³€í™˜: dense ë ˆì´ì–´ëŠ” 1ì°¨ì›ë§Œ ë°›ì„ ìˆ˜ ìˆê¸° ë•Œë¬¸ì—
x_train = x_train.reshape(60000,784)
x_test = x_test.reshape(10000,784)

# í¬ê¸° ë³€í™˜ í™•ì¸
x_train.shape # (60000, 784)
x_train[0] # array([  0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0,   0, ..., dtype=uint8)

# ì •ë‹µ ë°ì´í„°ë¥¼ ì›-í•« ì¸ì½”ë”©
y_train = tf.keras.utils.to_categorical(y_train)
y_test = tf.keras.utils.to_categorical(y_test)

# ë³€í™˜ ë°ì´í„° í˜•íƒœ í™•ì¸
y_train[0].shape # (10,) -> 0 ~ 9
y_train[0]  # array([  0,   0,   0,   0,   0,   0,   0,   0,   0,   0] dtype=uint8)
```

```PYTHON
# ëª¨ë¸ ìƒì„±
model = tf.keras.Sequential()
model.add(tf.keras.layers.Dense(512, activation="relu", input_shape=(784,))) 
model.add(tf.keras.layers.Dense(512, activation="relu"))
model.add(tf.keras.layers.Dense(10, activation="softmax"))

model.compile(optimizer="adam", loss=tf.keras.losses.CategoricalCrossentropy(), metrics=["accuracy"])

# x_test[0]ìœ¼ë¡œ ì˜ˆì¸¡í•´ë³´ê¸°
model.predict(x_test[0]) # ì—ëŸ¬ ë°œìƒ: train ë°ì´í„°ì˜ shapeì€ (60000,784)ì˜€ê¸° ë•Œë¬¸ì— 1ê°œì˜ ë°ì´í„°ë§Œì„ ê°€ì ¸ì˜¬ ë•Œì˜ shapeë¥¼ ì¸ì‹í•˜ì§€ ëª»í•¨ -> reshape í•„ìš”
test_data = x_test[0].reshape(1,784)
test_data.shape # (1, 784)

np.round(model.predict(test_data)) # array([[0., 0., 0., 0., 0., 0., 0., 1., 0., 0.]], dtype=float32) -> ìˆ«ì 7ì´ ë‹µ

# ì˜ˆì¸¡ ê²°ê³¼ì™€ ì‹¤ì œ ì´ë¯¸ì§€ í™•ì¸
test_data_img = x_test[0].reshape(28,28) # ì´ë¯¸ì§€ë¥¼ ë³´ê¸° ìœ„í•´ ë‹¤ì‹œ 28*28ë¡œ reshape
plt.imshow(test_data_img) # ìˆ«ì 7 ì´ë¯¸ì§€ê°€ ë³´ì—¬ì§„ ê²ƒì„ ë´¤ì„ ë•Œ, ì˜ˆì¸¡ì´ ì˜ ë˜ì—ˆìŒì„ í™•ì¸
```

![image-20220401183923620](220330.assets/image-20220401183923620.png)



## 4. ë¹„ì„ í˜• ë°ì´í„° ì˜ˆì¸¡

ì˜ˆì¸¡í•  data

```PYTHON
import tensorflow as tf
import numpy as np
import matplotlib.pyplot as plt

def make_random_data():
  x = np.random.uniform(low=-2, high=2, size=100)
  y = []
  for t in x:
      r = np.random.normal(loc=0.0, scale=(0.5 + t*t/3), size=None)
      y.append(r)
  return  x, x**3 + -1 + np.array(y)
# x^3 + -1 ì¸ ê³¡ì„  (x-1)(x^2+x+1)

x, y =  make_random_data()
plt.plot(x,y, "bo")
```

![image-20220406134517241](220330.assets/image-20220406134517241.png)

TanHë¡œ ëª¨ë¸ ìƒì„±

```python
model_regression = tf.keras.Sequential()
model_regression.add(tf.keras.layers.Dense(1, activation="tanh", input_shape=(1,)))
model_regression.add(tf.keras.layers.Dense(1))

model_regression.compile(optimizer="sgd", loss = "mse")
model_regression.fit(x, y, epochs = 100)

x_predict = np.arange(min(x), max(x), 0.01)
y_predict = model_regression.predict(x_predict)

plt.plot(x,y, "bo")
plt.plot(x_predict, y_predict, "red")
```

![image-20220406134611362](220330.assets/image-20220406134611362.png)

reluë¡œ ëª¨ë¸ ìƒì„±

```python
# ì—¬ëŸ¬ modelì„ ë§Œë“¤ì–´ì„œ ì˜ˆì¸¡
model_list = []
for i in range(1, 10):
  model_regression = tf.keras.Sequential()
  model_regression.add(tf.keras.layers.Dense(i, activation="relu", input_shape=(1,)))
  model_regression.add(tf.keras.layers.Dense(1))

  model_regression.compile(optimizer="sgd", loss="mse")
  model_regression.fit(x,y, epochs=500)

  model_list.append(model_regression)
    
model_list # 10ê°œì˜ ëª¨ë¸ì´ ìƒì„±ëœ ê²ƒì„ ë³¼ ìˆ˜ ìˆìŒ

# layer0 units ê°¯ìˆ˜ì— ë”°ë¥¸ regerssion ê³¡ì„ 
plt.subplots_adjust(bottom=5, top=10, 
                    wspace=0.2, 
                    hspace=0.35)
for i in range(0, len(model_list)):
  x_predict = np.arange(min(x), max(x), 0.01)
  y_predict = model_list[i].predict(x_predict) #modelì˜ predict ëœ ê²°ê³¼ë¥¼ ê·¸ë˜í”„ë¡œ í‘œí˜„í•´ ë³´ì. 
  plt.subplot(len(model_list)+1,1, i+1) # 1ê°œì˜ í–‰, model_listê¸¸ì´ ë§Œí¼ì˜ subplot
  plt.plot(x,y, "bo")
  plt.plot(x_predict, y_predict, "red")

# ì†ì‹¤í•¨ìˆ˜, modelì˜ unitsì˜ ê²°ê³¼ì— ë”°ë¼ í•™ìŠµëœ ê²°ê³¼ê°€ ë‹¬ë¼ì§„ë‹¤. 
# ê±°ë“­í• ìˆ˜ë¡ ì •êµí•´ ì§€ì§€ë§Œ overfitting ë¬¸ì œê°€ ë°œìƒí•  ìˆ˜ ì‡ë‹¤. 
```

unit1ì¼ ë•Œ

![image-20220406134910317](220330.assets/image-20220406134910317.png)

unit10ì¼ ë•Œ

![image-20220406134936023](220330.assets/image-20220406134936023.png)





---



#### ë°ì´í„°ë¥¼ ë‚˜ëˆ„ê¸° ìœ„í•œ ë‹¨ìœ„

- Epoch: ì „ì²´ sample ë°ì´í„°ë¥¼ ì´ìš©í•˜ì—¬ í•œ ë°”í€´ ëŒë©° í•™ìŠµí•˜ëŠ” ê²ƒì„ 1íšŒ epochì´ë¼ê³  í•¨
- Step: Weightì™€ Biasë¥¼ 1íšŒ ì—…ë°ì´íŠ¸ í•˜ëŠ” ê²ƒì„ 1stepì´ë¼ê³  í•¨
- Batch: 1stepì—ì„œ ì‚¬ìš©í•œ ë°ì´í„°ì˜ ìˆ˜
  - ex) batch size = 100, step = 5 -> ì•½ 500ê°œì˜ ë°ì´í„°ë¥¼ ì´ìš©í•œ ê²ƒ
- Iteratino: 1íšŒ í•™ìŠµì„ 1iterationì´ë¼ê³  í•¨



#### ë„ì›€ë§ ë³´ê¸°

- `help(tf.keras.Sequential)` ì½”ë“œ ì…ë ¥

- googleì— `tf.keras.Sequential` ê²€ìƒ‰í•˜ì—¬ docs í™•ì¸ (https://www.tensorflow.org/api_docs/python/tf/keras/Sequential)

  

#### ì›-í•« ì¸ì½”ë”© ì„¤ëª…

https://wikidocs.net/22647
